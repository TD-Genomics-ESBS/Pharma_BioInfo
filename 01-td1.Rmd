# Lectures NGS

Pour vous familiariser avec le contr√¥le qualit√© et le pr√©traitement des donn√©es brutes NGS, nous nous exercerons sur de petits sets de donn√©es. Les outils utilis√©s sont disponibles dans Galaxy, une plateforme pour l'analyse de donn√©es omiques. 

Avant de continuer : connectez-vous sur le site <https://usegalaxy.fr>. Pour cela, cliquez sur Se connecter ou cr√©er un nouveau compte_ (en haut de la page).

puis pour disposer de ressources suffisantes, allez sur l'url :

<https://usegalaxy.fr/join-training/TD1_Bioinformatique/>

Vous pouvez ensuite retourner sur Galaxy.


## Illumina SE

Optionnel: Vous pouvez renommer votre historique (panneau de droite).

Le 1er set de donn√©es concerne une √©tude m√©tag√©nomique portant sur le microbiome de la cavit√© orale d'un serpent. Apr√®s extraction et fragmentation de l'ADN de l'√©chantillon, une partie de g√®ne de l'ARNr 16S a √©t√© amplifi√© puis s√©quenc√© (Illumina Single End) afin d'identifier les bact√©ries pr√©sentes. Seule une partie des donn√©es sera analys√©e pour des raisons de temps.

### Raw data: FASTQ file

1. Importez le fichier FASTQ depuis le serveur zenodo : 

Copiez l'adresse du lien 

<https://zenodo.org/record/3977236/files/female_oral2.fastq-4143.gz>

Dans Galaxy, utilisez le bouton *Upload Data* (en haut √† gauche) puis *Paste/Fetch dat*a, copiez le lien et lancez (*start*).

2. Regardez le fichier (*eye icon*).

> ‚ùì Quelles sont les caract√©ristiques du format FASTQ ?

> ‚ùì Sachant que les scores sont encod√©s selon le syst√®me SANGER/Illumina 1.8+ (<https://support.illumina.com/help/BaseSpace_Sequence_Hub_OLH_009008_2/Source/Informatics/BS/QualityScoreEncoding_swBS.htm>), quelle est la valeur du score de la plupart des bases au d√©but du 1er read ? Est-ce satisfaisant?
    
### Contr√¥le qualit√© avec FastQE et FastQC

Ouvrir le FASTQ Quality Control toolbox (panneau de gauche).

#### FastQE

Explorer la qualit√© de vos s√©quences avec FASTQE. ‚ÄúMean scores‚Äù correspond √† la moyenne des scores calcul√©es sur toutes les lectures √† chaque position. Les scores sont repr√©sent√©s par des emojis (class√©s de 0 √† 41) : 

üö´‚ùåüë∫üíîüôÖüëæüëøüíÄüëªüôàüôâüôäüêµüòøüòæüôÄüí£üî•üò°üí©‚ö†Ô∏è
üòÄüòÖüòèüòäüòôüòóüòöüòÉüòòüòÜüòÑüòãüòÑüòùüòõüòúüòâüòÅüòÑüòéüòç

> ‚ùì Quelle est la tendance g√©n√©rale pour ce dataset?

#### FastQC

Evaluez plus en d√©tail la qualit√© des lectures avec FastQC (<https://www.bioinformatics.babraham.ac.uk/projects/fastqc/>. Voir FastQC website pour l'aide et des exemples d'analyse.

> ‚ùì *Per Base Sequence Quality*:  Quelle est la longueur des lectures ? Comment √©volue la qualit√© le long des lectures ?

> ‚ùì *Per sequence quality scores*: Que vous apprend ce graphe ?

> ‚ùì *Per base sequence content*: Dans le cas d'un s√©quen√ßage de g√©nome (sans amplification), √† quoi devrait ressembler ce graphe ? Le r√©sultat obtenu est-il normal dans notre cas ?

> ‚ùì *Adapter content*: Quel adaptateur est d√©tect√© ?

### Read procesing using Trimmomatic

Utilisez Trimmomatic (section FASTQ Quality control) pour am√©liorer la qualit√© des lectures :

- *Perform initial IllUMINACLIP step? Yes, select Nextera*

- *Sliding window trimming (proposed by default)*
  
- Ajouter une nouvelle op√©ration Trimmomatic : *Drop reads below a specific length (MINLEN): 20*

> ‚ùì Quel pourcentage de lectures a √©t√© √©limin√© (voir fichier log) ?

> ‚ùì Refaites une analyse FastQC sur les lectures apr√®s traitement et comparez les r√©sultats aux donn√©es brutes. Le r√©sultat est-il acceptable ?

## PacBio Hifi

Ce set de donn√©es contient 50 000 lectures PacBio HiFi provenant du s√©quen√ßage d'un g√©nome humain (PacBio - GIAB sample HG002).

Importez le fichier dans Galaxy :

<https://zenodo.org/api/files/ff9aa6e3-3d69-451f-9798-7ea69b475989/m64011_190830_220126.Q20.subsample.fastq.gz>

Effectuez le contr√¥le qualit√© avec Nanoplot (disponible dans Nanopore). Cet outil n'est utilisable que pour les lectures longues (PacBio ou Nanopore) :

- *Options for customizing the plot created:*

  - *Specify the bivariate format of the plots: dot*
  
  - *Show the N50 mark in the read length histogram: Yes*


Analyse: 


> ‚ùì On observe des variations importantes de taille de lecture dans les donn√©es PacBio, contrairement aux donn√©es Illumina. Pourquoi ? 

> ‚ùì Quelle est la longueur moyenne des lectures ?

> ‚ùì Comment est calcul√© le N5O dans ce cas ?

D√©fintion du N50: Dans le cadre de l'assemblage d'un g√©nome: 50% de l‚Äôassemblage est couvert par des contigs de longueur N50 ou sup√©rieure. Les contigs sont class√©s par ordre de longueur d√©croissante et leur taille additionn√©e. N50 est la longueur du plus petit contig de la liste n√©cessaire pour couvrir au moins 50% du g√©nome. Ici nous sommes dans le cadre d'un s√©quen√ßage et non pas dans le cadre de l'assemblage d'un g√©nome, les contigs sont donc des "reads" (ou "lectures" en fran√ßais).

> ‚ùì Quel peut √™tre l'utilit√© du graphique Yield by length ?

> ‚ùì Quelle est la qualit√© moyenne des lectures ?

> ‚ùì On n'observe aucune lecture avec Q<20. Pourquoi ? Y a-t-il un lien entre taille des lectures et qualit√© ?


## Nanopore

Le dernier set correspond √† des lectures nanopores obtenues √† partir d'un g√©nome de plante. Nous allons utiliser PycoQC pour le contr√¥le qualit√©. Celui ne fonctionne qu'avec des lectures Nanopores ; il n√©cessite des informations sp√©cifiques fournies par les basecallers nanopore tels que Guppy.

1. Importez les fichiers dans Galaxy :

<https://zenodo.org/api/files/ff9aa6e3-3d69-451f-9798-7ea69b475989/nanopore_basecalled-guppy.fastq.gz>

<https://zenodo.org/api/files/ff9aa6e3-3d69-451f-9798-7ea69b475989/sequencing_summary.txt>

2. Effectuez le contr√¥le qualit√© avec PycoQC

> ‚ùì Combien de reads sont disponibles ? Combien de bases cela repr√©sente ?

> ‚ùì Comment expliquez-vous l'√©cart entre taille m√©diane des lectures et N50 ? (Voir d√©finition du N50 dans la partie PacBio HiFi du TD)

> ‚ùì Que pouvez-vous dire de la distribution des longueurs ?

> ‚ùì Dans quel intervalle se situent la plupart des scores de qualit√© ?